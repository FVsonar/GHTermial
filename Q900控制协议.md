Q900控制协议V1.5

1、数据通信通过Q900内置声卡传输，可以通过声卡传输、读写数据。电台设置为USB模式的时候传输调制数据，电台设置为SDR模式的时候传输IQ数据。

2、控制协议数据可以通过蓝牙SPP、BLE、RS232、USB接口进行控制，协议遵循串口标准。

注：BLE

V1.0硬件

服务UUID: 0000FFF0-0000-1000-8000-00805F9B34FB

写特征：0000FFF2-0000-1000-8000-00805F9B34FB

通知特征：0000FFF1-0000-1000-8000-00805F9B34FB

V2.0硬件

UUID 列表
服务 UUID：FFE0
特征 UUID：FFE1 （用于串口透传，属性 notify、wirte）
特征 UUID：FFE2 （用于音频蓝牙或 SD 卡音乐播放控制，属性 Write）

协议格式：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 命令类型 | DATA | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | -------- | ---- | ----- | ----- |

包头：分别用四个0XA5作为包头。

| 0XA5 | 0XA5 | 0XA5 | 0XA5 |
| ---- | ---- | ---- | ---- |

包长：一个字节（BYTE），表示从包长下一个字节开始到包尾的字节长度。

命令类型：见协议内容

DATA：见协议内容。

校验：采用CRC校验方式，从包长到CRC高字节前一个字节，算法见附录一。

1、 PTT命令，用来控制电台PTT按下松开。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 07 | PTT | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | -- | --- | ----- | ----- |

PTT:0X00,按下PTT。0X01，PTT松开。

电台回复：

| [0XA5]() | 0XA5 | 0XA5 | 0XA5 | 包长 | 07 | PTT | CRC高 | CRC低 |
| ----- | ---- | ---- | ---- | ---- | -- | --- | ----- | ----- |

2、 频率设置命令，用来设置电台频率。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 09 | VFOA频率 | VFOB频率 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | -- | -------- | -------- | ----- | ----- |

频率:最大值十进制2000000000，四字节长度。

电台回复：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 09 | VFOA频率 | VFOB频率 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | -- | -------- | -------- | ----- | ----- |

3、 模式设置命令，用来设置电台模式。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X0A | VFOA模式 | VFOB模式 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | -------- | ----- | ----- |

模式:

0：USB

1：LSB

2：CWR

3：CWL

4：AM

5：WFM

6：NFM

7:  DIGI

8:  PKT

电台回复：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X0A | 模式 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ----- | ----- |

4、 频谱数据。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X39 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ----- | ----- |

电台发送：

| 0X7e | 0X7e | 0X7e | 0X7e | 频谱数据 |
| ---- | ---- | ---- | ---- | -------- |

V1.0硬件

频谱数据包长256个字节，无包头无校验，

V2.0硬件

频谱数据包长80个字节，无包头无校验，

频谱图：

大小代表Y轴高度，位置代表x位置绘图。

瀑布图：

大小代表颜色（蓝色+当前值），位置代表x位置绘图。

5、 状态同步命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X0B |  | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | - | ----- | ----- |

电台回复：

| 0XA5 | 0XA5 | 0XA5       | 0XA5     | 包长 | 0X0B    | 收发状态   | VFOA模式   | VFOB模式    | VFOA频率 | VFOB频率 | A/B | NR/NB |
| ---- | ---- | ---------- | -------- | ---- | ------- | ---------- | ---------- | ----------- | -------- | -------- | --- | ----- |
| RXT  | XIT  | 滤波器带宽 | 频谱带宽 | 电压 | UTC时间 | 状态栏状态 | S表/PO表值 | SWR/AUD/ALC | CRC高    | CRC低    |     |       |

收发状态：一字节

0：接收状态

1：发射状态

VFOA模式:一字节

0：USB

1：LSB

2：CWR

3：CWL

4：AM

5：WFM

6：NFM

7:  DIGI

8:  PKT

VFOB模式:一字节

0：USB

1：LSB

2：CWR

3：CWL

4：AM

5：WFM

6：NFM

7:  DIGI

8:  PKT

VFOA频率:最大值十进制2000000000，四字节长度。

VFOB频率:最大值十进制2000000000，四字节长度。

A/B:一字节

0:A频

1：B频

NR/NB：

0: NR/NB关

1：NR开

2：NB开

RIT:一字节

0~120

XIT: 一字节

0~120

滤波器带宽：一字节

0~50（序号对应滤波器见附表）

频谱带宽：一字节

0：48K

1: 24K

2: 12K

3:6K

4:3K

5:1.5K

电压：一字节

十进制值/10。

UTC时间：三字节

时：0~24

分:0~60

秒:0~60

状态栏：一字节

Bit0：1  蓝牙连接成功       0蓝牙断开

Bit1：1  GPS模块在线       0 GPS模块断线

Bit2：1  LORA模块在线      0 LORA模块断线

Bit3：1  电子罗盘模块在线   0电子罗盘模块断线

Bit4：1  天调开启          0天调关闭

Bit5：1  高功率            0低功率

S表/PO表值：一字节

接收状态时为S表：[]()0~34（BIT7为0时为S表）

发射为PO表：0~34（BIT7为1时为PO表）

SWR/AUD/ALC：一字节

SWR: 0~34（BIT7,BIT6为00时为SWR表）

ADU: 0~34（BIT7,BIT6为01时为ALC表）

ALC: 0~34（BIT7,BIT6为10时为ADU表）

6、 关机命令，关闭电台。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X0C | 0 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | - | ----- | ----- |

0：关机

1：开机

AF菜单：

7、 扬声器音量调节命令()。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X0D | 音量 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ----- | ----- |

音量：0~30

8、 耳机音量调节命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X0E | 耳机音量 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

耳机音量：0~80

9、 MIC增益调节命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X0F | MIC增益 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------- | ----- | ----- |

MIC增益：0~100

10、 语音压扩比调节命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X10 | 压扩比 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ----- | ----- |

压扩比：0~14

11、 低音EQ调节命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X11 | 低音EQ | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ----- | ----- |

低音EQ：0~40

12、 高音EQ调节命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X12 | 高音EQ | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ----- | ----- |

低音EQ：0~40

RF菜单：

13、 射频增益（RFG）调节命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X13 | 射频增益 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

射频增益：0~100

14、 中频增益（RFG）调节命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X14 | 中频增益 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

中频增益：0~80

15、 禁噪（SQL）调节命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X15 | 禁噪 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ----- | ----- |

禁噪：0~20

16、 自动增益控制（AGC）命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X16 | 自动增益 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

自动增益：0~5

17、 前级放大器（AMP）命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X17 | 前级放大器 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---------- | ----- | ----- |

前级放大器：0：AMPA  1:AMPB

18、 滤波器（filter）命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X18 | 滤波器 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ----- | ----- |

滤波器：

FM模式

| 1-<7.2k> | 2-<10.0k> | 3-<12.0k> |
| -------- | --------- | --------- |

CW/SSB 模式

| 4-<250_550>   | 5-<250_575>   | 6-<300_600>   | 7-<325_625>   | 8-<350_650>   |
| ------------- | ------------- | ------------- | ------------- | ------------- |
| 9-<375_675>   | 10-<400_700>  | 11-<425_725>  | 12-<450_750>  | 13-<475_775>  |
| 14-<275_775>  | 15-<325_825>  | 16-<375_875>  | 16-<375_875>  | 17-<425_925>  |
| 18-<475_975>  | 19-<0_1.4k>   | 20-<370_1.7k> | 21-<0_1.6k>   | 21-<0_1.6k>   |
| 23-<500_2.3k> | 24-<600_2.4K> | 25-<700_2.5k> | 26-<800_2.6k> | 26-<800_2.6k> |
| 28-<0_1.8k>   | 29-<0_2.1k>   | 30-<500_2.6k> | 31-<600_2.9k> | 31-<600_2.9k> |
| 33-<800_3.1k> | 34-<900_3.2k> | 35-<0_2.3k>   | 36-<0_2.5k>   |               |

SSB模式

| 37-<650_3.2k>  | 37-<650_3.2k> | 39-<700_3.4k>  | 40-<0_2.9k>   | 41-<800_3.7K> |
| -------------- | ------------- | -------------- | ------------- | ------------- |
| 42-<0_3.2k>    | 43-<900_4.1k> | 44-<0_3.4k>    | 45-<900_4.3k> | 46-<0_3.6k>   |
| 47-<1.0k_4.6k> | 48-<0_3.8K>   | 49-<1.1k_4.9k> | 50-<0_4.0k>   | 51-<0_4.2k>   |
| 52-<0_4.4K>    | 53-<0_4.6k>   | 54-<0_4.8k>    | 55-<0_5.0k>   | 56<0_5.5k>    |
| 57-<0_6.0k>    | 58-<0_6.5k>   | 59-<0_7.0k>    | 60-<0_7.5k>   | 61-<0_8.0k>   |
| 62-<0_8.5k>    | 63-<0_9.0k>   | 64-<0_9.5k>    | 65-<0_10.0k>  |               |

AM模式

| 66-<1.4k>  | 67-<1.6k> | 68-<1.8k> | 69-<2.0k> | 70-<2.3k> |
| ---------- | --------- | --------- | --------- | --------- |
| 71-<2.5k>  | 72-<2.7k> | 73-<2.8k> | 74-<3.2k> | 75-<3.4k> |
| 76-<3.6k>  | 77-<3.8k> | 78-<4.0k> | 79-<4.2k> | 80-<4.4k> |
| 81-<4.6k>  | 82-<4.8k> | 83-<5.0k> | 84-<6.0k> | 85-<7.5K> |
| 86-<10.0k> |           |           |           |           |

滤波器：0x01 – 0x55 共85个滤波器  按照模式分类4-36为CW模式和SSB模式都可以使用的滤波器

19、 NR命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X19 | NR | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -- | ----- | ----- |

NR: 0:NR关  1:NR开

20、 NB命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X1A | NB | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -- | ----- | ----- |

NR: 0:NB关  1:NB开

21、 AB频命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X1B | AB | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -- | ----- | ----- |

AB: 0:A频  1:B频2：A=B频

22、 异频命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X1C | SPLIT | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ----- | ----- | ----- |

SPLIT: 0:异频关  1:异频开

23、 频段选择命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X1D | 频段 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ----- | ----- |

频段:

| 1.8 | 3．5 | 5  | 7  | 10  | 14  | 18 |
| --- | ---- | -- | -- | --- | --- | -- |
| 21  | 24   | 28 | 50 | 144 | 430 |    |
|     |      |    |    |     |     |    |

24、 NR阀值设置命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X1E | NR阀值 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ----- | ----- |

NR阀值: 1~200

25、 NB阀值设置命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X1F | NR阀值 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ----- | ----- |

NR阀值: 0~15

26、 PEAK阀值设置命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X20 | NR阀值 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ----- | ----- |

NR阀值: 0~20

27、 天调设置命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X21 | 天调 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ----- | ----- |

天调: 0:天调关闭  1：天调开启  2：开始调谐

28、 频谱带宽命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X22 | SPAN | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ----- | ----- |

SPAN: 0~5

29、 频谱参考电平命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X23 | REF | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | --- | ----- | ----- |

REF: 1~20

30、 频谱刷新速率命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X24 | SPEED | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ----- | ----- | ----- |

SPEED: 1~30

31、 频谱显示模式命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X25 | 频谱显示模式 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------------ | ----- | ----- |

频谱显示模式: 0：频谱和瀑布同时显示 1：只显示频谱  2：只显示瀑布  3：频谱和瀑布图关闭

32、 模拟亚音。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X26 | 发射亚音 | 接收亚音 | 前导音 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | -------- | ------ | ----- | ----- |

发射亚音：

| 0     | 67.0  | 69.3  | 71.9  | 74.4  | 77.0  | 79.7  |
| ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 82.5  | 85.4  | 88.5  | 91.5  | 94.8  | 97.4  | 100.0 |
| 103.5 | 107.2 | 110.9 | 114.8 | 118.8 | 123.0 | 127.3 |
| 131.8 | 136.5 | 141.3 | 146.2 | 150.0 | 151.4 | 156.7 |
| 159.8 | 162.2 | 165.5 | 167.9 | 171.3 | 173.8 | 177.3 |
| 179.9 | 183.5 | 186.2 | 189.9 | 192.8 | 196.6 | 199.5 |
| 203.5 | 206.5 | 210.7 | 213.8 | 218.1 | 221.3 | 225.7 |
| 229.1 | 233.6 | 237.1 | 241.8 | 245.5 | 250.3 | 254.1 |

接收亚音：

| 0     | 67.0  | 69.3  | 71.9  | 74.4  | 77.0  | 79.7  |
| ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 82.5  | 85.4  | 88.5  | 91.5  | 94.8  | 97.4  | 100.0 |
| 103.5 | 107.2 | 110.9 | 114.8 | 118.8 | 123.0 | 127.3 |
| 131.8 | 136.5 | 141.3 | 146.2 | 150.0 | 151.4 | 156.7 |
| 159.8 | 162.2 | 165.5 | 167.9 | 171.3 | 173.8 | 177.3 |
| 179.9 | 183.5 | 186.2 | 189.9 | 192.8 | 196.6 | 199.5 |
| 203.5 | 206.5 | 210.7 | 213.8 | 218.1 | 221.3 | 225.7 |
| 229.1 | 233.6 | 237.1 | 241.8 | 245.5 | 250.3 | 254.1 |

前导音：

| 0 | 1750 | 2135 |  |
| - | ---- | ---- | - |

33、 设备类型识别命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X27 | 设备类型 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

电台回复：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X27 | 设备类型 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

设备类型: 0：Q900

34、 发射功率等级设置命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X28 | 功率等级 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

功率等级：0~100

电台回复：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X28 | 功率等级 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

35、 接收频偏设置命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X29 | RIT | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | --- | ----- | ----- |

RIT：0~120

电台回复：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X29 | RIT | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | --- | ----- | ----- |

36、 发射频偏设置命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X2A | XIT | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | --- | ----- | ----- |

RIT：0~120

电台回复：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X2A | XIT | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | --- | ----- | ----- |

37、 前导音发射时长设置命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X2B | L-TIME | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ----- | ----- |

L-TIME：50 - 300

电台回复：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X2B | L-TIME | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ----- | ----- |

38、 高低功率等级设置命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X2C | 功率等级 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

功率等级：

0：低功率

1：高功率

电台回复：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X2C | L-TIME | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ----- | ----- |

39、 驻波表、S表、ALC表、发射功率表同步命令(控制端轮询)。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X2D | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ----- | ----- |

电台发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X2D | 发射功率/S表 | SWR/AUD/ALC | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------------ | ----------- | ----- | ----- |

S表：0~34（BIT7为0时为S表）

发射功率：0~34（BIT7为1时为PO表）

SWR/AUD/ALC：一字节

SWR: 0~34（BIT7,BIT6为00时为SWR表）

ADU: 0~34（BIT7,BIT6为01时为ALC表）

ALC: 0~34（BIT7,BIT6为10时为ADU表）

40、 参数同步命令(定时轮询实现同步)。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X2E | 数据包 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ----- | ----- |

电台发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X2E | SVOL | HVOL | MIC | CMP | BAS | TRB | RFG | IFG |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | --- | --- | --- | --- | --- | --- |

| SQL | AGC | AMP | NR | NB | PEAK | SPAN | REF | SPEED | T-CTSS | R-CTSS |
| --- | --- | --- | -- | -- | ---- | ---- | --- | ----- | ------ | ------ |

| L-VOICE | L-TIME | KEY_MODE | TX_RX | TRANING | STF | STG | KEY_SPEED |
| ------- | ------ | -------- | ----- | ------- | --- | --- | --------- |

| DECODE | THRESHOLD | 数据格式 | CRC高 | CRC低 |
| ------ | --------- | -------- | ----- | ----- |

41、 电键类型设置命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X2F | 电键类型 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

电键类型： 0:AUTO-L 1:AUTO-R  2：KEY

电台发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X2F | 电键类型 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

42、 侧音音量设置命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X30 | 侧音音量 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

侧音音量：0~15 步进1

电台发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X30 | 侧音音量 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

43、 侧音频率设置命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X31 | 侧音频率 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

侧音音量：40~20 步进2

电台发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X31 | 侧音频率 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

电台收到后需要乘以10.

44、 收发转换时间设置命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X32 | 转换时间 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

侧音音量：0~50 步进1

电台发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X32 | 转换时间 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

电台收到后需要乘以40.

45、 USB数据格式设置命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X33 | 数据格式 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

数据格式：0：音频1：IQ

电台发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X33 | 数据格式 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

46、 CW练习模式设置命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X34 | TRAINING | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

练习模式：0：关 1：开

电台发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X34 | TRAINING | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ----- | ----- |

47、 CW自动键速度设置命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X35 | KEY_SPEED | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | --------- | ----- | ----- |

自动键速度：5~48 步进1

电台发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X35 | KEY_SPEED | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | --------- | ----- | ----- |

48、 CW解码设置命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X36 | DECODE | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ----- | ----- |

解码开关：0：关 1：开

电台发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X36 | DECODE | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ----- | ----- |

49、 CW解码阈值设置命令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X37 | THERSHOLD | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | --------- | ----- | ----- |

CW解码阈值：1~50 步进1

电台发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X37 | THERSHOLD | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | --------- | ----- | ----- |

50、 MESH数传通信（支持LORA、2FSK、4FSK）。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X38 | 数据包 | C | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | - | ----- |

数据包：

| 0x7e | 0x7e | 源地址 | 目的地址 | MESH跳数 | 总包数 | 包号 | 数据 | 前向纠错 |  |
| ---- | ---- | ------ | -------- | -------- | ------ | ---- | ---- | -------- | - |

源地址：2字节

目的地址：2字节

MESH跳数：1字节

总包数：1字节

包号：1字节

数据：固定225字节

51、 信道写频命令，用来写电台信道频率。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X40 | 信道高 | 信道低 | VFOA模式 | VFOB模式 | VFOA频率 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ------ | -------- | -------- | -------- |

| VFOB频率 | 发射亚音 | 接收亚音 | 信道名 | CRC高 | CRC低 |
| -------- | -------- | -------- | ------ | ----- | ----- |

信道：0~999，最大值999

频率:最大值十进制2000000000，四字节长度。

模式:

0：USB

1：LSB

2：CWR

3：CWL

4：AM

5：WFM

6：NFM

7:  DIGI

8:  PKT

9：DMR

10:DFM

信道名：英文字符，最大12个字节

发射亚音：

| 0     | 67.0  | 69.3  | 71.9  | 74.4  | 77.0  | 79.7  |
| ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 82.5  | 85.4  | 88.5  | 91.5  | 94.8  | 97.4  | 100.0 |
| 103.5 | 107.2 | 110.9 | 114.8 | 118.8 | 123.0 | 127.3 |
| 131.8 | 136.5 | 141.3 | 146.2 | 150.0 | 151.4 | 156.7 |
| 159.8 | 162.2 | 165.5 | 167.9 | 171.3 | 173.8 | 177.3 |
| 179.9 | 183.5 | 186.2 | 189.9 | 192.8 | 196.6 | 199.5 |
| 203.5 | 206.5 | 210.7 | 213.8 | 218.1 | 221.3 | 225.7 |
| 229.1 | 233.6 | 237.1 | 241.8 | 245.5 | 250.3 | 254.1 |

接收亚音：

| 0     | 67.0  | 69.3  | 71.9  | 74.4  | 77.0  | 79.7  |
| ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 82.5  | 85.4  | 88.5  | 91.5  | 94.8  | 97.4  | 100.0 |
| 103.5 | 107.2 | 110.9 | 114.8 | 118.8 | 123.0 | 127.3 |
| 131.8 | 136.5 | 141.3 | 146.2 | 150.0 | 151.4 | 156.7 |
| 159.8 | 162.2 | 165.5 | 167.9 | 171.3 | 173.8 | 177.3 |
| 179.9 | 183.5 | 186.2 | 189.9 | 192.8 | 196.6 | 199.5 |
| 203.5 | 206.5 | 210.7 | 213.8 | 218.1 | 221.3 | 225.7 |
| 229.1 | 233.6 | 237.1 | 241.8 | 245.5 | 250.3 | 254.1 |

电台回复：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X40 | 信道 | VFOA模式 | VFOB模式 | VFOA频率 | VFOB频率 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | -------- | -------- | -------- | -------- |

| 发射亚音 | 接收亚音 | 信道名 | CRC高 | CRC低 |
| -------- | -------- | ------ | ----- | ----- |

52、 信道读命令，用来读电台信道参数。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X41 | 信道高 | 信道低 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ------ | ----- | ----- |

电台回复：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X41 | 信道高 | 信道低 | VFOA模式 | VFOB模式 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ------ | -------- | -------- |

| VFOA频率 | VFOB频率 | 发射亚音 | 接收亚音 | 信道名 | CRC高 | CRC低 |
| -------- | -------- | -------- | -------- | ------ | ----- | ----- |

信道：0~999，最大值999

频率:最大值十进制2000000000，四字节长度。

模式:

0：USB

1：LSB

2：CWR

3：CWL

4：AM

5：WFM

6：NFM

7:  DIGI

8:  PKT

9：DMR

10:DFM

信道名：英文字符，最大12个字节

发射亚音：

| 0     | 67.0  | 69.3  | 71.9  | 74.4  | 77.0  | 79.7  |
| ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 82.5  | 85.4  | 88.5  | 91.5  | 94.8  | 97.4  | 100.0 |
| 103.5 | 107.2 | 110.9 | 114.8 | 118.8 | 123.0 | 127.3 |
| 131.8 | 136.5 | 141.3 | 146.2 | 150.0 | 151.4 | 156.7 |
| 159.8 | 162.2 | 165.5 | 167.9 | 171.3 | 173.8 | 177.3 |
| 179.9 | 183.5 | 186.2 | 189.9 | 192.8 | 196.6 | 199.5 |
| 203.5 | 206.5 | 210.7 | 213.8 | 218.1 | 221.3 | 225.7 |
| 229.1 | 233.6 | 237.1 | 241.8 | 245.5 | 250.3 | 254.1 |

接收亚音：

| 0     | 67.0  | 69.3  | 71.9  | 74.4  | 77.0  | 79.7  |
| ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 82.5  | 85.4  | 88.5  | 91.5  | 94.8  | 97.4  | 100.0 |
| 103.5 | 107.2 | 110.9 | 114.8 | 118.8 | 123.0 | 127.3 |
| 131.8 | 136.5 | 141.3 | 146.2 | 150.0 | 151.4 | 156.7 |
| 159.8 | 162.2 | 165.5 | 167.9 | 171.3 | 173.8 | 177.3 |
| 179.9 | 183.5 | 186.2 | 189.9 | 192.8 | 196.6 | 199.5 |
| 203.5 | 206.5 | 210.7 | 213.8 | 218.1 | 221.3 | 225.7 |
| 229.1 | 233.6 | 237.1 | 241.8 | 245.5 | 250.3 | 254.1 |

53、 信道模式切换。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X42 | 模式 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ----- | ----- |

模式：0频率模式 1信道模式

电台回复：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X42 | 模式 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ----- | ----- |

54、 DMR信道设置。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X43 | 信道高 | 信道低 | Call_format | Tx_cc | Rx_cc |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ------ | ----------- | ----- | ----- |

| slot | Call_id(4字节) | Own_id(4字节) | Ch_type | Rx_ctcss | Tx_ctcss | sqlevel | spkgain |
| ---- | -------------- | ------------- | ------- | -------- | -------- | ------- | ------- |

| dmrexist | dmod_gain | scr_en | scr_seed(2字节) | ch_bs_mode | validat | CRC高 | CRC低 |
| -------- | --------- | ------ | --------------- | ---------- | ------- | ----- | ----- |

Call_format ：0-2

Tx_cc ：0-15

Rx_cc ：0-15

Call_id ：4字节1-16777214

Own _id ：4字节 1-16777214

Slot : 1-2

Ch_type : 0-1

Rx_ctcss ：1-51

Tx_ctcss ：1-51

Sqlevel ：1-5

spkgain : 0-10

dmod_gain ：0-95

scr_seed ：2字节

ch_bs_mode : 0-1

Dmrexist:不需要编辑

Validat:不需要编辑

scr_en：0不加密 1加密

电台回复：

| [0XA5]() | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X43 | 信道高 | 信道低 | Call_format | Tx_cc | Rx_cc |
| ----- | ---- | ---- | ---- | ---- | ---- | ------ | ------ | ----------- | ----- | ----- |

| slot | Call_id | Own_id | Ch_type | Rx_ctcss | Tx_ctcss | sqlevel | spkgain |
| ---- | ------- | ------ | ------- | -------- | -------- | ------- | ------- |

| dmrexist | dmod_gain | scr_en | scr_seed | ch_bs_mode | validat | CRC高 | CRC低 |
| -------- | --------- | ------ | -------- | ---------- | ------- | ----- | ----- |

55、 DMR信道读取。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X44 | 信道高 | 信道低 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ------ | ----- | ----- |

模式：0频率模式 1信道模式

电台回复：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X44 | 信道高 | 信道低 | Call_format | Tx_cc | Rx_cc |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ------ | ----------- | ----- | ----- |

| slot | Call_id | Own_id | Ch_type | Rx_ctcss | Tx_ctcss | sqlevel | spkgain |
| ---- | ------- | ------ | ------- | -------- | -------- | ------- | ------- |

| dmrexist | dmod_gain | scr_en | scr_seed | ch_bs_mode | validat | CRC高 | CRC低 |
| -------- | --------- | ------ | -------- | ---------- | ------- | ----- | ----- |

Call_format ：0-2、

Tx_cc ：0-15、

Rx_cc ：0-15、

Call_id：4字节1-16777214、

Own _id：4字节 1-16777214、

slot:1-2、

Ch_type :0-1、

Rx_ctcss：1-51、

Tx_ctcss：1-51、

sqlevel：1-5、

spkgain :0-10、

dmod_gain：0-95、

scr_seed：2字节、

ch_bs_mode: 0-1

Dmrexist:不需要编辑

Validat:不需要编辑

scr_en：0不加密 1加密

56、 IQ带宽设置。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X45 | IQ带宽 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ----- | ----- |

IQ带宽：

0:200K

1:300K

2:600K

3:1.536MHz

4:5 MHz

5:7 MHz

6:8 MHz

默认0：200K

电台回复：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X45 | IQ带宽 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ------ | ----- | ----- |

57、 天调调谐指令。

APP发送：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X46 | 调谐模式 | 驻波调谐值 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ---------- | ----- | ----- |

调谐模式：

0:自动调谐（默认）

1:指令开始调谐

3：关闭调谐模式

调谐值：10~140（调谐驻波值），接收到后除以10即为驻波值

电台回复：调谐完成后回复

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X46 | 调谐模式 | 驻波调谐值 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ---------- | ----- | ----- |

调谐模式：

0:自动调谐（默认）

1:指令调谐

3：调谐模式关闭

调谐后的驻波值：10~140（调谐驻波值），接收到后除以10即为驻波值

58、 天调状态同步指令。 (定时器,定时刷新显示)

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X47 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | ----- | ----- |

天调回复：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X47 | 调谐模式 | 驻波调谐值 | 电压 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ---------- | ---- | ----- | ----- |

调谐模式：

0:自动调谐（默认）

1:指令调谐

3：调谐模式关闭

调谐后的驻波值：10~140（调谐驻波值），接收到后除以10即为驻波值

电压：0~256，收到的值除以10电压，单位V

59、 天调校准指令。

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X48 | 正向功率校准值 | 驻波校准值 | 电压校准值 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------------- | ---------- | ---------- |

| CRC高 | CRC低 |
| ----- | ----- |

正向功率校准值：0~200

驻波校准值：0~200

电压校准值：0~200

注明：0~99为负值校准：100~200为正值校准 (99是-100)

天调回复：

| 0XA5 | 0XA5 | 0XA5 | 0XA5 | 包长 | 0X48 | 正向功率 | 驻波 | 电压 | CRC高 | CRC低 |
| ---- | ---- | ---- | ---- | ---- | ---- | -------- | ---- | ---- | ----- | ----- |

正向功率：校准后的值

驻波：校准后的驻波

电压：校准后的电压

附录1

10.CRC校验算法 结果验证网址 [http://www.ip33.com/crc.html](http://www.ip33.com/crc.html)

![](file:///C:\Users\17994\AppData\Local\Temp\ksohtml22440\wps1.jpg)

//****************************************************

//** 函数名称: CRC16Check  

//** 输    入: buf 要校验的数据;

//**             len 要校验的数据的长度

//** 输    出: 校验值

//** 功能描述: CRC16循环冗余校验

//** 备注：校验模式为CRC16/CCITT-FALSE，注意变量类型

//*****************************************************/

unsigned int CRC16Check(unsigned char *buf, unsigned char len)

{

    unsigned char  i, j;

    unsigned int uncrcReg = 0xFFFF;

    unsigned int uncur;

    for (i = 0; i < len; i++)

    {

    uncur = buf[i] << 8;

    for (j = 0; j < 8; j++)

    {

    if ((int)(uncrcReg ^ uncur) < 0)

    {

    uncrcReg = (uncrcReg << 1) ^ 0x1021;

    }

    else

    {

    uncrcReg <<= 1;

    }

    uncur <<= 1;

    }

    }

    return uncrcReg;

}

更改通知：

1、 将第五点协议内容数据为调换

原数据格式：

ALC: 0~34（BIT7,BIT6为01时为ALC表）

ADU: 0~34（BIT7,BIT6为10时为ADU表）

更改后：

ADU: 0~34（BIT7,BIT6为01时为ALC表）

ALC: 0~34（BIT7,BIT6为10时为ADU表）

![](file:///C:\Users\17994\AppData\Local\Temp\ksohtml22440\wps2.png)

重庆国赫电子科技有限公司

申明：本协议内容版权归重庆国赫电子科技有限公司所有，可以随意传播，但不可以更改协议内容。
